{"version":3,"file":"Invitation.f21bd73c.js","sources":["../../src/assets/images/invitation.png","../../src/views/team/Invitation.vue"],"sourcesContent":["export default \"__VITE_ASSET__7ac31645__\"","<template>\n  <div class=\"invitation-container\" v-loading=\"loading\">\n    <el-image style=\"width: 200px; height: 200px\" :src=\"invitationImg\" fit=\"fill\"/>\n    <div class=\"mb-5\" style=\"font-size: 16px;font-weight: 400;color: #212930;\">Hi, <b>{{ info?.nickname || 'navigationline' }}</b>邀请您加入团队\n    </div>\n    <div class=\"mb-5\"\n         style=\"font-size: 14px;font-weight: 500;color: #212930;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;\">\n      <span style=\"color: #ffffff;font-size: 18px;display: inline-block;width: 28px;height: 28px;background-color: #3B82F6;border-radius: 4px;text-align: center;\">{{ info?.teamName?.substring(0, 1) }}</span>\n      <span class=\"ml-1\" style=\"display: inline-block\">{{ info?.teamName }}</span>\n    </div>\n    <el-input v-model=\"name\" size=\"large\" placeholder=\"请填写您的真实姓名，便于团队成员间协作（必填）\" class=\"mb-5\"/>\n    <el-button type=\"primary\" size=\"large\" :disabled=\"!sureBtnEnable\" @click=\"handleAddTeamMember\">确认加入</el-button>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, onMounted, ref} from \"vue\";\nimport {useRouter} from 'vue-router';\nimport {router} from \"@/router/index\";\nimport invitationImg from '@/assets/images/invitation.png'\nimport {fetchAddTeamMemeber, fetchTeamInfoByInviteId} from \"@/api/fetchs/team\";\nimport {RouteEnum} from \"@/enums/routeEnum\";\nimport {getSearchParams} from \"@/utils/form\";\nimport {ElMessage, ElMessageBox} from \"element-plus/es\";\nimport {useUserStore} from \"@/store/modules/user\";\nimport {useTeamStore} from \"@/store/modules/team\";\n\nconst r = useRouter();\n\nconst inviteId = r.currentRoute.value.query.inviteId\n\nconst teamStore = useTeamStore()\n\nconst name = ref<string>('')\nconst info = ref<any>()\nconst loading = ref<boolean>(false)\nconst sureBtnEnable = computed(() => name.value.length > 0)\n\nonMounted(() => {\n  const paramName = r.currentRoute.value.query.name\n  if(paramName) {\n    name.value = paramName + ''\n  }\n})\n\n/* ================================== fetchs ================================== */\nasync function handleGetTeamInfo() {\n  loading.value = true\n\n  try {\n    const {data} = await fetchTeamInfoByInviteId(inviteId)\n    if (!data) {\n      router.push(RouteEnum.INVITATION_ERROR + \"/\" + RouteEnum.HIDE_CHILDREN_IN_MENU)\n    } else {\n      info.value = data\n    }\n  } finally {\n    loading.value = false\n  }\n}\n\nhandleGetTeamInfo()\n\nasync function handleAddTeamMember() {\n  const form = {inviteId, nickname: name.value}\n  const params = getSearchParams(form)\n\n  const {status} = await fetchAddTeamMemeber(params)\n\n  if(status == 1) {\n    ElMessage.success('加入成功')\n    teamStore.setActiveTeamId(info.value.teamId)\n    teamStore.setActiveTeamType(info.value.teamType)\n    router.push(RouteEnum.TEAM)\n  } else if(status == 3) {\n    // ElMessageBox.confirm('未登录，请先进行登录', '提示', {\n    //   confirmButtonText: '确认',\n    //   cancelButtonText: '取消',\n    //   type: 'warning'\n    // })\n    //   .then(() => {\n    //     const userStore = useUserStore()\n    //     router.push(RouteEnum.BASIC_LOGIN + '?callback=https://www.navigationline.cn/team/invitation/index?inviteId=' + inviteId + '&name=' + name.value)\n    //     userStore.resetState()\n    //     return false\n    //   })\n    //   .catch(() => {\n    //     return false\n    //   })\n    const userStore = useUserStore()\n    router.push(RouteEnum.BASIC_LOGIN + '?callback=' + window.location.origin + '/team/invitation/index?inviteId=' + inviteId + '&name=' + name.value)\n    userStore.resetState()\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.invitation-container {\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  .el-button {\n    width: 100%;\n  }\n}\n</style>\n"],"names":["invitationImg","r","useRouter","inviteId","teamStore","useTeamStore","name","ref","info","loading","sureBtnEnable","computed","onMounted","paramName","handleGetTeamInfo","__async","data","fetchTeamInfoByInviteId","router","RouteEnum","handleAddTeamMember","form","params","getSearchParams","status","fetchAddTeamMemeber","ElMessage","userStore","useUserStore"],"mappings":"8cAAA,IAAeA,EAAA,yiBC2Bf,MAAMC,EAAIC,IAEJC,EAAWF,EAAE,aAAa,MAAM,MAAM,SAEtCG,EAAYC,IAEZC,EAAOC,EAAY,EAAE,EACrBC,EAAOD,IACPE,EAAUF,EAAa,EAAK,EAC5BG,EAAgBC,EAAS,IAAML,EAAK,MAAM,OAAS,CAAC,EAE1DM,EAAU,IAAM,CACd,MAAMC,EAAYZ,EAAE,aAAa,MAAM,MAAM,KAC1CY,IACDP,EAAK,MAAQO,EAAY,GAC3B,CACD,EAGD,SAAeC,GAAoB,QAAAC,EAAA,sBACjCN,EAAQ,MAAQ,GAEZ,GAAA,CACF,KAAM,CAAC,KAAAO,CAAQ,EAAA,MAAMC,EAAwBd,CAAQ,EAChDa,EAGHR,EAAK,MAAQQ,EAFbE,EAAO,KAAKC,EAAU,iBAAmB,IAAMA,EAAU,qBAAqB,CAGhF,QACA,CACAV,EAAQ,MAAQ,EAClB,CACF,GAEkBK,IAElB,SAAeM,GAAsB,QAAAL,EAAA,sBACnC,MAAMM,EAAO,CAAC,SAAAlB,EAAU,SAAUG,EAAK,KAAK,EACtCgB,EAASC,EAAgBF,CAAI,EAE7B,CAAC,OAAAG,CAAU,EAAA,MAAMC,EAAoBH,CAAM,EAEjD,GAAGE,GAAU,EACXE,EAAU,QAAQ,0BAAM,EACdtB,EAAA,gBAAgBI,EAAK,MAAM,MAAM,EACjCJ,EAAA,kBAAkBI,EAAK,MAAM,QAAQ,EACxCU,EAAA,KAAKC,EAAU,IAAI,UAClBK,GAAU,EAAG,CAerB,MAAMG,EAAYC,IACXV,EAAA,KAAKC,EAAU,YAAc,aAAe,OAAO,SAAS,OAAS,mCAAqChB,EAAW,SAAWG,EAAK,KAAK,EACjJqB,EAAU,WAAW,CACvB,CACF"}