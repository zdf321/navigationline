var p=(e,o,t)=>new Promise((s,n)=>{var l=r=>{try{d(t.next(r))}catch(u){n(u)}},f=r=>{try{d(t.throw(r))}catch(u){n(u)}},d=r=>r.done?s(r.value):Promise.resolve(r.value).then(l,f);d((t=t.apply(e,o)).next())});import{u as D}from"./usePage.57f3776c.js";import{r as v,e as i,f as c,d as S,g as O,o as R,l as h,i as w,w as E,j as y,R as m,u as k,a as C,y as M,z as A,h as G,k as N,A as x,n as F}from"./index.dcc91eec.js";import{D as a,u as L,_ as b}from"./useFiles.042f9960.js";import{M as U}from"./menuValueEnum.ea7dad60.js";var P=(e=>(e[e.LOGIN=0]="LOGIN",e[e.REGISTER=1]="REGISTER",e[e.RESET_PASSWORD=2]="RESET_PASSWORD",e[e.MOBILE=3]="MOBILE",e[e.QR_CODE=4]="QR_CODE",e))(P||{});const g=v(0);function z(){function e(s){g.value=s}const o=i(()=>c(g));function t(){e(0)}return{setLoginState:e,getLoginState:o,handleBackLogin:t}}function J(e){function o(){return p(this,null,function*(){const t=c(e);return t?yield t.validate():void 0})}return{validForm:o}}function K(e){const o=i(()=>I("\u8BF7\u8F93\u5165\u5BC6\u7801")),t=i(()=>H()),s=i(()=>I("\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801")),n=i(()=>V());return{getFormRules:i(()=>{const f=c(o),d=c(t),r=c(s),u=c(n);switch(c(g)){case 1:return{account:u,password:d};case 2:return{account:u};case 3:return{code:r,account:u};default:return{account:u,password:f}}})}}function I(e){return[{required:!0,message:e,trigger:"change"}]}function V(){return[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"change"}]}function H(){return[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"change"}]}const q={class:"user-auth"},Z=S({__name:"unauth",setup(e){const o=D();z();function t(){o(m.BASIC_LOGIN+"?callback="+window.location.href)}return(s,n)=>{const l=O("el-button");return R(),h("div",q,[w(l,{type:"primary",round:"",onClick:t},{default:E(()=>n[0]||(n[0]=[y("\u767B\u5F55")])),_:1})])}}}),Y={class:"user-dropdown"},ee=S({__name:"user",props:{nextHandle:{default:0}},setup(e){const o=e,t=[{icon:"menu-self-file",iconSize:20,text:"\u6211\u7684\u6587\u4EF6",divided:!1,key:a.MY_FILE},{icon:"drop-uc",iconSize:20,text:"\u8D26\u6237\u4E2D\u5FC3",divided:!0,key:a.USER_CENTER},{icon:"menu-guid",iconSize:20,text:"\u5165\u95E8\u6559\u7A0B",divided:!1,key:a.GETTING_STARTED},{icon:"menu-index",iconSize:20,text:"\u5B98\u7F51\u9996\u9875",divided:!1,key:a.HOME_INDEX},{icon:"drop-logout",iconSize:20,text:"\u9000\u51FA\u767B\u5F55",divided:!0,key:a.LOGOUT}],s=v(!1),n=k(),l=C(),{handleFolderMenuChange:f}=L();function d(u){switch(u.key){case a.LOGOUT:s.value=!0,setTimeout(()=>p(this,null,function*(){yield n.logout(o.nextHandle||0),s.value=!1}),500);break;case a.USER_CENTER:F.push(m.SETTING);break;case a.MY_FILE:r();break;case a.GETTING_STARTED:window.open(m.GETTING_STARTED,"_blank");break;case a.HOME_INDEX:F.push(m.BASIC_ROOT);break}}function r(){F.push(m.SELF_FILE);let u=n.getUserInfo;l.setActiveTeamId(u.myTeamId),l.setActiveTeamType("PERSONAL");let _={icon:"menu-self-file",text:"\u6211\u7684\u6587\u4EF6",value:U.MY_FILE,spaceId:u.myTeamSpaceId};f(_)}return(u,_)=>{const B=M("loading");return R(),h("div",Y,[w(b,{dropMenuList:t,onMenuEvent:d},{default:E(()=>{var T;return[A((R(),G(c(x),{src:(T=c(n).getUserInfo)==null?void 0:T.avatar,class:"cursor-pointer"},{default:E(()=>_[0]||(_[0]=[N("img",{src:"http://i.navigationline.cn/system/default/avatar.png"},null,-1)])),_:1},8,["src"])),[[B,s.value]])]}),_:1})])}}});function te(){const e=k(),o=i(()=>!!e.getToken),t=i(()=>e.getUserInfo);return{hasLogin:o,getUserInfo:t}}export{P as L,Z as _,z as a,J as b,te as c,ee as d,K as u};
//# sourceMappingURL=useUserLogin.4e082603.js.map
