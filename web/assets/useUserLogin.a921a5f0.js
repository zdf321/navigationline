var _=(e,u,t)=>new Promise((s,r)=>{var d=n=>{try{l(t.next(n))}catch(o){r(o)}},m=n=>{try{l(t.throw(n))}catch(o){r(o)}},l=n=>n.done?s(n.value):Promise.resolve(n.value).then(d,m);l((t=t.apply(e,u)).next())});import{u as D}from"./usePage.d2f65d4f.js";import{r as v,e as i,f as c,d as h,g as O,o as F,l as S,i as w,w as R,j as C,R as f,u as k,a as y,y as M,z as A,h as G,k as N,A as x,n as p}from"./index.96d3aca4.js";import{D as a,u as L,_ as b}from"./useFiles.8ce8d7f0.js";import{M as U}from"./menuValueEnum.ea7dad60.js";import{a as P}from"./avatar.9103c0b9.js";var z=(e=>(e[e.LOGIN=0]="LOGIN",e[e.REGISTER=1]="REGISTER",e[e.RESET_PASSWORD=2]="RESET_PASSWORD",e[e.MOBILE=3]="MOBILE",e[e.QR_CODE=4]="QR_CODE",e))(z||{});const E=v(0);function V(){function e(s){E.value=s}const u=i(()=>c(E));function t(){e(0)}return{setLoginState:e,getLoginState:u,handleBackLogin:t}}function ee(e){function u(){return _(this,null,function*(){const t=c(e);return t?yield t.validate():void 0})}return{validForm:u}}function te(e){const u=i(()=>I("\u8BF7\u8F93\u5165\u5BC6\u7801")),t=i(()=>q()),s=i(()=>I("\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801")),r=i(()=>H());return{getFormRules:i(()=>{const m=c(u),l=c(t),n=c(s),o=c(r);switch(c(E)){case 1:return{account:o,password:l};case 2:return{account:o};case 3:return{code:n,account:o};default:return{account:o,password:m}}})}}function I(e){return[{required:!0,message:e,trigger:"change"}]}function H(){return[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"change"}]}function q(){return[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"change"}]}const Y={class:"user-auth"},oe=h({__name:"unauth",setup(e){const u=D();V();function t(){u(f.BASIC_LOGIN+"?callback="+window.location.href)}return(s,r)=>{const d=O("el-button");return F(),S("div",Y,[w(d,{type:"primary",round:"",onClick:t},{default:R(()=>r[0]||(r[0]=[C("\u767B\u5F55")])),_:1})])}}}),$={class:"user-dropdown"},Q=["src"],ue=h({__name:"user",props:{nextHandle:{default:0}},setup(e){const u=e,t=[{icon:"menu-self-file",iconSize:20,text:"\u6211\u7684\u6587\u4EF6",divided:!1,key:a.MY_FILE},{icon:"drop-uc",iconSize:20,text:"\u8D26\u6237\u4E2D\u5FC3",divided:!0,key:a.USER_CENTER},{icon:"menu-guid",iconSize:20,text:"\u5165\u95E8\u6559\u7A0B",divided:!1,key:a.GETTING_STARTED},{icon:"menu-index",iconSize:20,text:"\u5B98\u7F51\u9996\u9875",divided:!1,key:a.HOME_INDEX},{icon:"drop-logout",iconSize:20,text:"\u9000\u51FA\u767B\u5F55",divided:!0,key:a.LOGOUT}],s=v(!1),r=k(),d=y(),{handleFolderMenuChange:m}=L();function l(o){switch(o.key){case a.LOGOUT:s.value=!0,setTimeout(()=>_(this,null,function*(){yield r.logout(u.nextHandle||0),s.value=!1}),500);break;case a.USER_CENTER:p.push(f.SETTING);break;case a.MY_FILE:n();break;case a.GETTING_STARTED:window.open(f.GETTING_STARTED,"_blank");break;case a.HOME_INDEX:p.push(f.BASIC_ROOT);break}}function n(){p.push(f.SELF_FILE);let o=r.getUserInfo;d.setActiveTeamId(o.myTeamId),d.setActiveTeamType("PERSONAL");let g={icon:"menu-self-file",text:"\u6211\u7684\u6587\u4EF6",value:U.MY_FILE,spaceId:o.myTeamSpaceId};m(g)}return(o,g)=>{const B=M("loading");return F(),S("div",$,[w(b,{dropMenuList:t,onMenuEvent:l},{default:R(()=>{var T;return[A((F(),G(c(x),{src:(T=c(r).getUserInfo)==null?void 0:T.avatar,class:"cursor-pointer"},{default:R(()=>[N("img",{src:c(P)},null,8,Q)]),_:1},8,["src"])),[[B,s.value]])]}),_:1})])}}});function se(){const e=k(),u=i(()=>!!e.getToken),t=i(()=>e.getUserInfo);return{hasLogin:u,getUserInfo:t}}export{z as L,oe as _,V as a,ee as b,se as c,ue as d,te as u};
//# sourceMappingURL=useUserLogin.a921a5f0.js.map
